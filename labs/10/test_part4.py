#!/usr/bin/python3
# test_part4.py

from rsa import *
pk = (7131849252317293258692923999798781766407525490234774806736152308305216261726438763297272033641006718552037303588909689922814973488190321528330622025645803691237366174336675345474218958129358579770043741560622182225879794003825603682984930153591024535162658181930103790869788166588673925043585909482241, 
6075068761538163845608410885374838834122581641122728606474918449160953114998314280285915221354917813580508000150146072778764041002136166044071832013332848235379552299746904684100114131234629186331930460166475384184303578098072994456222520972542488056250717133808032647528902152743665651924409826486091)

sk = (7131849252317293258692923999798781766407525490234774806736152308305216261726438763297272033641006718552037303588909689922814973488190321528330622025645803691237366174336675345474218958129358579770043741560622182225879794003825603682984930153591024535162658181930103790869788166588673925043585909482241, 
3532415437897815461357358153131077437109455121231279697937262852877946723140667364977944816094760395183042455407709853217327092421065324331416988387699632020235772624890189050853444135976098434746589038372143370730636466608749109400817694666600215891589857489976287425984921294540942609314238653642259)

m = 12345678901234567890
print("m =", m)

c = enc(pk, m)
print("enc(pk, m):", c) 

m1 = dec(sk,c)
print("dec(sk, c):", m1) 

print("pk1, sk1 = gen(200)")
pk1, sk1 = gen(200)
print("dec(sk1, enc(pk1, m)):", dec(sk1, enc(pk1, m)))

m = b"hello"
(n, e, d) = (pk[0], pk[1], sk[1]) 
print()
print("n=", n)
print("e=", e)
print("d=", d) 

c = enc_oaep(pk, m)
m2 = dec_oaep(n, e, d, c)
print()
print("dec_oaep(n, e, d, c)=", m2)

print("modifying the last byte of c into c1...")
c1 = bytearray(c)
c1[-1] = 0
m3 = dec_oaep(pk[0], pk[1], sk[1], c1)
print("dec_oaep(n, e, d, c1)=", m3)


